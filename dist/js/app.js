let map;function initMap(){map=new google.maps.Map(document.getElementById('map'),{center:{lat:40.7339945,lng:-73.9858134},zoom:12,disableDefaultUI:!0}),ko.applyBindings(new VM)}function mapError(){'use strict';document.getElementById('message').innerHTML='<h2>Google Maps couldn\'t be reached. Please refresh the page and check your internet connection.</h2>'}const bathroomArray=[{id:'4d9c92f4baae54815f2cde64',name:'Dream Downtown',lat:40.742291,lng:-74.0056441},{id:'5866c6299398ab0830a60b8d',name:'Stewart Hotel',lat:40.7487243,lng:-73.9938283},{id:'54419745498e8a6b5608301b',name:'The Milling Room',lat:40.783747,lng:-73.9766567},{id:'56f32b83cd1058e40988b7e4',name:'The William Vale Hotel',lat:40.722283,lng:-73.9588797},{id:'439ab2a9f964a520d12b1fe3',name:'Bam Rose Cinemas',lat:40.6863328,lng:-73.9797778},{id:'5487845b498ed6d0cef81f32',name:'Gotan',lat:40.7192553,lng:-74.0087969},{id:'4d531ddd7e0f8eec112b8ae4',name:'Corkbuzz',lat:40.7350748,lng:-73.99533},{id:'49d18dfdf964a5208f5b1fe3',name:'The Plaza',lat:40.7644691,lng:-73.9766764},{id:'560a9d9b498e4a17fa12b88f',name:'Routine',lat:40.689767,lng:-73.9081967}];let Bathroom=function(a){'use strict';this.lat=ko.observable(a.lat),this.lng=ko.observable(a.lng),this.name=ko.observable(a.name),this.id=ko.observable(a.id),this.bio=ko.observable(''),this.website=ko.observable(''),this.img=ko.observable(''),this.card=ko.observable('')},VM=function(){'use strict';let a=this;this.bathrooms=ko.observableArray([]);let b,c=new google.maps.InfoWindow({maxWidth:300});bathroomArray.forEach(function(b){a.bathrooms.push(new Bathroom(b))}),a.bathrooms().forEach(function(a){b=new google.maps.Marker({position:new google.maps.LatLng(a.lat(),a.lng()),map:map,animation:google.maps.Animation.DROP}),a.marker=b,$.ajax({url:'https://api.foursquare.com/v2/venues/'+a.id()+'?client_id=0K0OIU022VPILROCPI32UUS1IUAQ4EC332OSQJ24NJRF1SQU&client_secret=Z1KWVRGSHJVPMH2UZOPWZQKJM2OABK3FXHW5B04M3KKXIB4M&v=20170731',dataType:'json',success:function(b){let d=b.response.venue,e=d.hasOwnProperty('url')?d.url:'';a.website(e||''),d.bestPhoto.hasOwnProperty('prefix')&&d.bestPhoto.hasOwnProperty('suffix')?a.img(d.bestPhoto.prefix+'250x250'+d.bestPhoto.suffix||''):a.img('');let f=d.hasOwnProperty('description')?d.description:'';a.bio(f||'');let g='<div id="bathroomCard"><img id="bathroomPhoto" src="'+a.img()+'" alt="Image of Location"><h1>'+a.name()+'</h1><p><a href='+a.website()+'><i class="material-icons">info</i> Visit website</a> <a target="_blank" href=https://www.google.com/maps/dir/Current+Location/'+a.lat()+','+a.lng()+'><i class="material-icons">location_on</i> Get directions</a></p><p>'+a.bio()+'</p></div>';google.maps.event.addListener(a.marker,'click',function(){c.open(map,this),a.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.marker.setAnimation(null)},500),c.setContent(g),map.setCenter(a.marker.getPosition())})},error:function(){google.maps.event.addListener(a.marker,'click',function(){c.open(map,this),a.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.marker.setAnimation(null)},500),c.setContent('<p>Data not found. :(</p>'),map.setCenter(a.marker.getPosition())}),document.getElementById('message').innerHTML='<p>Data not found. :(</p>'}})}),a.showCard=function(a){google.maps.event.trigger(a.marker,'click')},a.searchResults=ko.observableArray(),a.bathrooms().forEach(function(b){a.searchResults.push(b)}),a.userInput=ko.observable(''),a.searchResultsMarkers=function(){let b=a.userInput().toLowerCase();a.searchResults.removeAll(),a.bathrooms().forEach(function(c){c.marker.setVisible(!1),-1!==c.name().toLowerCase().indexOf(b)&&a.searchResults.push(c)}),a.searchResults().forEach(function(a){a.marker.setVisible(!0)})}};